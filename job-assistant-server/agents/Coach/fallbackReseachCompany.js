export const createFallbackResearch = (companyName) => {
  return `## Research Guide for ${companyName}
  
  Since detailed company-specific information is limited, here's a comprehensive guide on how to research this company effectively:
  
  ---
  
  ## ðŸŒ Where to Research
  
  ### Official Company Sources
  - **Company Website**: Visit their official website and explore:
    - About Us / Company Info section
    - Mission statement and core values
    - Products and services page
    - News / Press releases section
    - Blog and thought leadership content
    - Customer case studies and testimonials
  
  - **Careers Page**: Check their careers section for:
    - Company culture descriptions
    - Employee benefits and perks
    - Team photos and culture videos
    - Job posting details and requirements
  
  ### Professional Networks
  - **LinkedIn**: 
    - Company page for recent updates and employee count
    - Employee profiles (especially those in similar roles)
    - Posts and articles from company leadership
    - Alumni network and career progression paths
    - Endorsements and skills most common in the company
  
  - **Glassdoor**:
    - Employee reviews (current and former employees)
    - Interview experiences and questions asked
    - Salary information and compensation insights
    - CEO approval rating
    - Work-life balance ratings
  
  - **Indeed & Other Job Boards**:
    - Additional employee reviews
    - Job posting history and growth indicators
    - Benefits and compensation details
  
  ### News & Industry Sources
  - **Google News**: Search "${companyName} news" for:
    - Recent announcements and press releases
    - Product launches or major updates
    - Leadership changes or new hires
    - Funding rounds or financial performance
    - Awards and recognition
  
  - **Industry Publications**: Look for mentions in:
    - Tech news sites (TechCrunch, VentureBeat, etc.)
    - Business publications (Forbes, Bloomberg, WSJ)
    - Industry-specific trade journals
    - Competitor analysis reports
  
  ### Social Media
  - **Twitter / X**: Company official account and employee tweets
  - **Facebook**: Company page and community engagement
  - **Instagram**: Company culture, events, and behind-the-scenes
  - **YouTube**: Product demos, company videos, conference talks
  
  ---
  
  ## ðŸŽ¯ Key Research Areas
  
  ### 1. Company Basics
  Research and note:
  - [ ] Year founded
  - [ ] Company size (number of employees)
  - [ ] Headquarters location(s)
  - [ ] Funding stage or public/private status
  - [ ] Main products or services
  - [ ] Target customers/market
  - [ ] Key competitors
  
  ### 2. Company Culture & Values
  Understand:
  - [ ] Core values and mission statement
  - [ ] Work environment (remote, hybrid, in-office)
  - [ ] Team structure and collaboration style
  - [ ] Diversity and inclusion initiatives
  - [ ] Employee growth and development opportunities
  - [ ] Work-life balance philosophy
  
  ### 3. Recent Developments
  Find out about:
  - [ ] New products or features launched (last 6 months)
  - [ ] Major partnerships or collaborations
  - [ ] Expansion plans or new office locations
  - [ ] Recent funding or financial milestones
  - [ ] Notable hires or leadership changes
  - [ ] Industry awards or recognition
  
  ### 4. Interview Process Intel
  Research:
  - [ ] Typical number of interview rounds
  - [ ] Common interview formats (technical, behavioral, case study)
  - [ ] Average interview difficulty (from Glassdoor reviews)
  - [ ] Timeline from application to offer
  - [ ] Assessment or take-home projects
  - [ ] Who you'll interview with (roles and names if possible)
  
  ---
  
  ## ðŸ’¡ Preparing Thoughtful Questions
  
  ### Questions About the Role
  1. "What does success look like in this role in the first 30/60/90 days?"
  2. "What are the biggest challenges the person in this role will face?"
  3. "How does this role contribute to the company's overall goals?"
  4. "What opportunities for growth and advancement exist in this position?"
  5. "What's the team structure, and who would I be working with most closely?"
  
  ### Questions About the Company
  1. "What excites you most about ${companyName}'s future?"
  2. "How has the company culture evolved as you've grown?"
  3. "What's the biggest challenge ${companyName} is facing right now?"
  4. "How does ${companyName} differentiate itself from competitors?"
  5. "What's your favorite thing about working here?"
  
  ### Questions About Technology/Process (if applicable)
  1. "What's your technology stack and why did you choose it?"
  2. "How does your team approach collaboration and communication?"
  3. "What does your development/deployment process look like?"
  4. "How do you handle work-life balance on the team?"
  5. "What opportunities are there for learning and professional development?"
  
  ### Questions About Impact
  1. "What's the most impactful project your team has worked on recently?"
  2. "How does this team/department contribute to company goals?"
  3. "What metrics define success for this role and team?"
  
  ---
  
  ## ðŸ“‹ Interview Preparation Checklist
  
  ### Before the Interview
  - [ ] Research 3-5 recent company news items or achievements
  - [ ] Understand their main products/services thoroughly
  - [ ] Know their competitors and market position
  - [ ] Identify 2-3 company values you connect with
  - [ ] Prepare 5-7 thoughtful questions to ask
  - [ ] Review Glassdoor interview experiences
  - [ ] Connect with current/former employees on LinkedIn (if appropriate)
  - [ ] Understand the role's responsibilities deeply
  - [ ] Prepare STAR method examples matching their needs
  
  ### During Research
  - [ ] Take notes on key findings
  - [ ] Screenshot important pages/posts for quick reference
  - [ ] Create a document with company facts and figures
  - [ ] List questions as they come to mind
  - [ ] Note any concerns or red flags
  
  ---
  
  ## ðŸš© Red Flags to Watch For
  
  During your research, be aware of:
  - Consistently negative employee reviews (especially recent ones)
  - High turnover rates or many similar positions open
  - Vague job descriptions or unrealistic requirements
  - Poor communication during interview process
  - Lack of diversity in leadership
  - Financial instability or recent layoffs
  - Misalignment between stated values and employee experiences
  - Unprofessional online presence or controversial news
  
  ---
  
  ## âœ… How to Stand Out
  
  ### Show You've Done Your Homework
  - Reference specific company initiatives or products in your answers
  - Align your responses with their stated values
  - Ask questions that show deep understanding
  - Mention recent news or achievements naturally
  
  ### Demonstrate Fit
  - Connect your experience to their specific challenges
  - Show enthusiasm for their mission and products
  - Provide examples that match their culture
  - Express genuine interest in their technology/approach
  
  ### Be Authentic
  - Don't just regurgitate research; provide your perspective
  - Be honest about what excites you and any concerns
  - Ask real questions you genuinely want answered
  - Show your personality and how you'd fit the team
  
  ---
  
  ## ðŸ”— Recommended Research Tools
  
  - **Google Alerts**: Set up alerts for company name
  - **LinkedIn Sales Navigator** (if available): Deep company insights
  - **Crunchbase**: Startup funding and growth data
  - **BuiltIn**: Tech company profiles and culture info
  - **Owler**: Company news and competitor analysis
  - **SimilarWeb**: Website traffic and online presence data
  
  ---
  
  ## ðŸ“ Final Tips
  
  1. **Start Early**: Begin research 3-5 days before interview
  2. **Take Notes**: Create a research document for quick review
  3. **Practice**: Incorporate research into your answer practice
  4. **Stay Updated**: Check for news on the morning of interview
  5. **Be Genuine**: Don't force research into every answer
  6. **Follow Up**: Reference your research in thank-you notes
  
  ---
  
  ## ðŸŽ¯ Next Steps
  
  1. Spend 2-3 hours conducting thorough research using sources above
  2. Create a one-page "cheat sheet" with key facts and questions
  3. Practice weaving company knowledge into your interview answers
  4. Prepare 2-3 specific examples of why you're excited about ${companyName}
  5. Review your notes 30 minutes before the interview
  
  **Remember**: The goal isn't to memorize everything about the company, but to demonstrate genuine interest and strategic thinking about how you'd contribute to their success.
  
  Good luck with your interview at ${companyName}! ðŸš€`;
};

export const validateResearch = (research) => {
  const minLength = 300;
  const requiredSections = [
    "Company Overview",
    "Culture",
    "Interview",
    "Questions",
  ];

  if (research.length < minLength) {
    logger.warn(`Research too short: ${research.length} characters`);
    return false;
  }

  const missingSections = requiredSections.filter(
    (section) => !research.includes(section)
  );

  if (missingSections.length > 0) {
    logger.warn(`Missing sections: ${missingSections.join(", ")}`);
    return false;
  }

  return true;
};
export const extractKeyFacts = (research) => {
  const facts = {
    companySize: extractPattern(research, /(\d+[+,]?\s*employees?)/i),
    founded: extractPattern(research, /(founded|established)\s+in\s+(\d{4})/i),
    location: extractPattern(
      research,
      /(headquarter|based|located)\s+in\s+([\w\s,]+)/i
    ),
    industry: extractPattern(research, /(industry|sector):\s*([\w\s]+)/i),
  };

  return facts;
};

const extractPattern = (text, pattern) => {
  const match = text.match(pattern);
  return match ? match[0] : null;
};
